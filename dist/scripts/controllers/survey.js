"use strict";angular.module("sbAdminApp").controller("SurveyCtrl",function($scope,$compile){$scope.listKnowledgeAreas=[],$scope.listAnswerOptions=[],$scope.currentAnswer,$scope.showAlert=function(message){$("#alert").html("<div class='alert alert-danger'><a href='#' class='close' data-dismiss='alert' aria-label='close'>&times;</a>"+message+"</div>"),$("#alert").alert(),$("#alert").fadeTo(3e3,500).slideUp(500,function(){$("#alert").alert("close")})},$scope.addKnowledgeArea=function(name){""!=name?-1==$.inArray(name.toLowerCase(),$scope.listKnowledgeAreas)?(angular.element(document.getElementById("accordion")).append($compile("<knowledge-area name="+name+"></knowledge-area>")($scope)),$("#accordion .collapse").removeClass("in"),$("#accordion").sortable({handle:".panel-heading"}),$scope.listKnowledgeAreas.push(name.toLowerCase())):$scope.showAlert("Area de conocimiento ya ha sido agregada."):$scope.showAlert("Debe seleccionar o digitar un area de conocimiento.")},$scope.addAnswerOption=function(){var name=$("#txtAnswer").val();""!=name?-1==$.inArray(name,$scope.listAnswerOptions[$scope.currentAnswer])?(angular.element(document.getElementById("listAnswerOptions")).append($compile('<ka-answer name="'+name+'"></ka-answer>')($scope)),$("#listAnswerOptions").sortable(),$scope.listAnswerOptions[$scope.currentAnswer].push(name),$("#txtAnswer").val(""),$("#txtAnswer").focus()):$scope.showAlert("Opción de respuesta repetida."):$scope.showAlert("Debe digitar una opción de respuesta.")},$scope.init=function(){$("#accordion").collapse();var knowledgeAreas=["Ciencias","Matematicas","Sociales","Etica","Ingles","EspaÃ±ol"];$("#txtApKnowledgeArea").autocomplete({source:knowledgeAreas,select:function(event,ui){$scope.addKnowledgeArea(ui.item.value)}}),$("#answer-options-modal").on("show.bs.modal",function(e){$("#txtAnswer").focus()}),$("#answer-options-modal").on("show.bs.modal",function(e){if($("#txtAnswer").val(""),$("#listAnswerOptions").empty(),$scope.listAnswerOptions[e.relatedTarget.id])for(var i=0;i<$scope.listAnswerOptions[e.relatedTarget.id].length;i++)angular.element(document.getElementById("listAnswerOptions")).append($compile('<ka-answer name="'+$scope.listAnswerOptions[e.relatedTarget.id][i]+'"></ka-answer>')($scope));else $scope.listAnswerOptions[e.relatedTarget.id]=[];$scope.currentAnswer=e.relatedTarget.id})}});